<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Decore Company</title>
    <link rel="stylesheet" href="/assets/user/home.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/bootstrap.css" />
    <style>
      .header h2 {
        color: #333; 
       text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.192);
        
      }
      .favorite-btn.active i {
    color: red; /* Change the color or add any other styles for the active state */
}
/* Checked star */
.fa-star.checked {
  color: #f8c45b; /* Change the color to your preferred color */
}

/* Half-checked star */
.fa-star.half-checked {
  color: #f8c45b; /* Change the color to your preferred color */
}

/* Unchecked star */
.fa-star {
  color: #ccc; /* Change the color to your preferred color */
}

/* Optionally, you can style the product-rating container */
.product-rating {
  margin-top: 5px; /* Adjust as needed */
}

.product-rating .fa {
  font-size: 20px; /* Adjust the font size of stars */
}
.product-card {
    /* Add styles for product card */
    transition: transform 0.3s ease;
  }

  /* Hover effect for product card */
  .product-card:hover {
    transform: scale(1.05);
  }

    </style>
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar">
      <div class="left">
        <img
          src="/img/furniture-logo.jpg"
          alt="Decore Company Logo"
          class="company-logo"
        />
        <span class="company-name">DECORE COMPANY</span>
      </div>
      <div class="center">
        <!-- <div class="search-bar">
          <input type="text" id="searchInput" placeholder="Search...">
          <button type="button" onclick="searchProducts()">Search</button>
      </div> -->
        <form action="/search" method="get">
          <div class="search-bar">
              <input type="text"  name="q" placeholder="Search...">
              <button type="submit">Search</button>
          </div>
        </form>
    </div>
      <div class="right">
        <a href="/home">Home</a>
        <a href="/cart">Cart</a>
        <a href="/whishlist">Favorites</a>
        <a href="/logout">Logout</a>
        <a href="/newprofile">Profile</a>
        
         
          
            <div class="dropdown">
              <a class="btn dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Category
              </a>
          
              <div class="dropdown-menu" aria-labelledby="dropdownMenuLink" >
                  <a class="dropdown-item" href="/homeproduct">Home</a>
                  <a class="dropdown-item" href="/office">Office</a>
              </div>
          
          </div>
        
      </div>
    </nav>

    <!-- Banner -->
    <div id="carouselExampleCaptions" class="carousel slide" style="box-shadow: 7px 5px 112px rgba(255, 209, 205, 0.498);">
      <div class="carousel-indicators">
        <button
          type="button"
          data-bs-target="#carouselExampleCaptions"
          data-bs-slide-to="0"
          class="active"
          aria-current="true"
          aria-label="Slide 1"
        ></button>
        <button
          type="button"
          data-bs-target="#carouselExampleCaptions"
          data-bs-slide-to="1"
          aria-label="Slide 2"
        ></button>
        <button
          type="button"
          data-bs-target="#carouselExampleCaptions"
          data-bs-slide-to="2"
          aria-label="Slide 3"
        ></button>
      </div>
      <div class="carousel-inner">
        <div class="carousel-item active">
          <img
            src="/img/new 111.jpg"
            class="d-block w-100"
            alt="..."
          />
          <div class="carousel-caption d-none d-md-block">
            <h2>Eco-Friendly Design</h2>
            <p>Each piece of furniture whispers a unique narrative</p>
          </div>
        </div>
        <div class="carousel-item">
          <img
            src="/img/new3.jpg"
            class="d-block w-100"
            alt="..."
          />
          <div class="carousel-caption d-none d-md-block">
            <h2>Timeless Elegance</h2>
            <p>"Furniture, with its silent eloquence, adorns our living spaces like poetry in a room, "</p>
          </div>
        </div>
        <div class="carousel-item">
          <img src="/img/new4.jpg" class="d-block w-100" alt="..." />
          <div class="carousel-caption d-none d-md-block">
            <h2>Functional Innovation</h2>
            <p>creating not just functional pieces, but captivating expressions of beauty."</p>
          </div>
        </div>
      </div>
      <button
        class="carousel-control-prev"
        type="button"
        data-bs-target="#carouselExampleCaptions"
        data-bs-slide="prev"
      >
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button
        class="carousel-control-next"
        type="button"
        data-bs-target="#carouselExampleCaptions"
        data-bs-slide="next"
      >
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>

    <!-- Category -->
    <!-- Category -->
    <div class="header" style="margin-top: 60px;">
        <h2>What You Looking For</h2>
      </div>

    <div class="Categories" style="margin-bottom: 100px;margin-top:50px;">
       
      <div class="category-list" onclick="location.href='/homeproduct';" style="cursor: pointer; padding-left: 120px ; ">
        <!-- Category 1 -->
        <div class="card mb-3" style="max-width: 540px; box-shadow: 1px 6px 12px rgba(0, 0, 0, 0.262);  background-image:url(https://cdn.shopify.com/s/files/1/0274/7429/6892/products/D101-brown-marble-texture-background-abstract-marble-texture_1024x1024.jpg?v=1577244530);">
          <div class="row g-0">
            <div class="col-md-4" >
             <a href="/homeproduct">
              <img src="/img/chairs category.webp" class="img-fluid rounded-start" alt="..." />
             </a>
            </div>
            <div class="col-md-8">
              <div class="card-body">
                <h5 class="card-title">HOME</h5>
                <p class="card-text">
                  This is a wider card with supporting text below as a natural
                  lead-in to additional content. This content is a little bit
                  longer.
                </p>
                <p class="card-text">
                  <!-- <small class="text-body-secondary"
                    >Last updated 3 mins ago</small
                  > -->
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="category-list" onclick="location.href='/office';" style="cursor: pointer;">
        <!-- Category 2 -->
        <div class="card mb-3" style="max-width: 540px; box-shadow: 1px 6px 12px rgba(0, 0, 0, 0.262); background-image:url(https://cdn.shopify.com/s/files/1/0274/7429/6892/products/D101-brown-marble-texture-background-abstract-marble-texture_1024x1024.jpg?v=1577244530);">
          <div class="row g-0">
            <div class="col-md-4">
              <a href="/office">
              <img src="/img/office.jpg" class="img-fluid rounded-start" alt="..." />
              </a>
            </div>
            <div class="col-md-8">
              <div class="card-body">
                <h5 class="card-title">OFFICE</h5>
                <p class="card-text">
                  This is a wider card with supporting text below as a natural
                  lead-in to additional content. This content is a little bit
                  longer.
                </p>
                <p class="card-text">
                  <!-- <small class="text-body-secondary"
                    >Last updated 3 mins ago</small
                  > -->
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
      
    </div>

    <!-- Header -->
    <div class="header">
      <h2>Explore Our Latest Furniture Collection</h2>

      <div class="dropdown" style="position: absolute; top: 155%; right: 50px;">
        <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" style="background-color: #800000; border-color: #800000; box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);">
          Sort By
        </button>
        <ul class="dropdown-menu" style="box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);">
          <li><a class="dropdown-item" href="/Home/popularity">Popularity</a></li>
          <li><a class="dropdown-item" href="/Home/priceLowToHigh">Price: Low to High</a></li>
          <li><a class="dropdown-item" href="/Home/priceHighToLow">Price: High to Low</a></li>
          <li><a class="dropdown-item" href="/Home/averageRatings">Average Ratings</a></li>
          <li><a class="dropdown-item" href="/Home/featured">Featured</a></li>
          <li><a class="dropdown-item" href="/Home/newArrivals">New Arrivals</a></li>
          <li><a class="dropdown-item" href="/Home/aToZ">A-Z</a></li>
          <li><a class="dropdown-item" href="/Home/zToA">Z-A</a></li>
         
        </ul>
      </div>
    </div>

    </div>

    <!-- Products -->
    <div class="product">
      <% 
      const inStockProducts = products.filter(product => product.stockCount > 0);
      const outOfStockProducts = products.filter(product => product.stockCount <= 0);
    
      inStockProducts.forEach(product => { %>
        <div class="product-card">
          <a href="/display/<%= product.id %>">
            <div class="product-tumb">
              <img src="<%= product.productImage[0] %>" alt="<%= product.productName %>">
            </div>
            <div class="product-details">
              <h4><a href="/display/<%= product.id %>"><%= product.productName %></a></h4>
              <div class="product-rating">
                <% if (product.averageRating > 0) { %>
                  <% for(let i = 1; i <= 5; i++) { %>
                    <% if (i <= product.averageRating) { %>
                      <span class="fa fa-star checked"></span>
                    <% } else if (i == Math.ceil(product.averageRating) && product.averageRating % 1 !== 0) { %>
                      <span class="fa fa-star half-checked"></span>
                    <% } else { %>
                      <span class="fa fa-star"></span>
                    <% } %>
                  <% } %>
                <% } else { %>
                  <span></span>
                <% } %>
              </div>
              <div class="product-bottom-details">
                <% if (product.offerDiscountPercentage > 0) { %>
                  <div class="product-price">
                    <span style="text-decoration: line-through;color:#33333368 ;">₹<%= product.price %></span> 
                    <span style="color: rgb(142, 0, 0);"><%= product.price - (product.price * product.offerDiscountPercentage / 100).toFixed(2) %> </span>
                  </div>
                <% } else { %>
                  <div class="product-price">₹<%= product.price %></div>
                <% } %>
                <div class="product-links">
                  <a href="#" class="favorite-btn" data-product-id="<%= product.id %>">
                    <i class="fa fa-heart"></i>
                  </a>
                  <a href="#" class="add-to-cart-btn" data-product-id="<%= product.id %>" data-stock-count="<%= product.stockCount %>">
                    <i class="fa fa-shopping-cart"></i>
                  </a>
                </div>
              </div>
            </div>
          </a>
        </div>
      <% }); %>
    
      <% 
      outOfStockProducts.forEach(product => { %>
        <div class="product-card">
          <a href="/display/<%= product.id %>">
            <div class="product-tumb">
              <img src="<%= product.productImage[0] %>" alt="<%= product.productName %>">
            </div>
            
            <div class="product-details">
              <h4><a href="/display/<%= product.id %>"><%= product.productName %></a></h4>
              <div class="product-rating">
                <% if (product.averageRating > 0) { %>
                  <% for(let i = 1; i <= 5; i++) { %>
                    <% if (i <= product.averageRating) { %>
                      <span class="fa fa-star checked"></span>
                    <% } else if (i == Math.ceil(product.averageRating) && product.averageRating % 1 !== 0) { %>
                      <span class="fa fa-star half-checked"></span>
                    <% } else { %>
                      <span class="fa fa-star"></span>
                    <% } %>
                  <% } %>
                <% } else { %>
                  <span></span>
                <% } %>
              </div>
              <div class="product-price" style="color: rgb(255, 0, 0);">Out of Stock</div>
              <div class="product-bottom-details">
                <% if (product.offerDiscountPercentage > 0) { %>
                  <div class="product-price">
                    <span style="text-decoration: line-through;color:#33333368 ;">₹<%= product.price %></span> 
                    <span style="color: rgb(142, 0, 0);"><%= product.price - (product.price * product.offerDiscountPercentage / 100).toFixed(2) %> </span>
                  </div>
                <% } else { %>
                  <div class="product-price">₹<%= product.price %></div>
                <% } %>
               
                <div class="product-links">
                  <a href="#" class="favorite-btn" data-product-id="<%= product.id %>">
                    <i class="fa fa-heart"></i>
                  </a>
                  <a href="#" class="add-to-cart-btn" data-product-id="<%= product.id %>" data-stock-count="<%= product.stockCount %>">
                    <i class="fa fa-shopping-cart"></i>
                  </a>
                </div>
              </div>
            </div>
          </a>
        </div>
      <% }); %>
    </div>
    
    
    

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-content">
        <div class="footer-section about">
          <h4>About Us</h4>
          <p>
            Decore Company is your one-stop destination for high-quality
            furniture. Explore our exclusive collection to find the perfect
            pieces for your home.
          </p>
        </div>
        <div class="footer-section contact">
          <h4>Contact Information</h4>
          <p>Email: info@decorecompany.com</p>
          <p>Phone: +1 (123) 456-7890</p>
        </div>
        <div class="footer-section social">
          <h4>Follow Us</h4>
          <a href="#" class="social-icon"
          ><img src="/img/facebook-scalable-graphics-icon-facebook-logo-facebook-logo-png-clip-art.png" alt="Facebook"
        /></a>
        <a href="#" class="social-icon"
          ><img src="/img/Twitter_new_X_logo.png" alt="Twitter"
        /></a>
        <a href="#" class="social-icon"
          ><img src="/img/1658586823instagram-logo-transparent.webp" alt="Instagram"
        /></a>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2024 Decore Company. All Rights Reserved.</p>
      </div>
    </footer>
<!-- Include SweetAlert2 from CDN -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
  document.addEventListener('DOMContentLoaded', () => {
      const addToCartButtons = document.querySelectorAll('.add-to-cart-btn');

      addToCartButtons.forEach(button => {
          button.addEventListener('click', (event) => {
              event.preventDefault();
              const productId = button.getAttribute('data-product-id');
              const stockCount = button.getAttribute('data-stock-count');

              if (parseInt(stockCount) > 0) {
                  addToCart(productId);
              } else {
                  Swal.fire({
                      title: 'Out of Stock!',
                      text: 'This product is currently out of stock.',
                      icon: 'error',
                      confirmButtonText: 'OK'
                  });
              }
          });
      });

      function addToCart(productId) {
          fetch(`/add-to-cart/${productId}`, {
              method: 'POST',
          })
              .then(response => response.json())
              .then(data => {
                  Swal.fire({
                      title: 'Success!',
                      text: data.message,
                      icon: 'success',
                      confirmButtonText: 'OK'
                  });
              })
              .catch(error => console.error('Error:', error));
      }
        const searchInput = document.getElementById('searchInput');
            searchInput.value = '';
  });

  function searchProducts() {
      const searchQuery = document.getElementById('searchInput').value;
      
      if (searchQuery.trim() !== '') {
          fetch(`/search?query=${searchQuery}`, {
              method: 'GET',
          })
              .then(response => response.json())
              .then(products => {
                  updateProductSection(products);
              })
              .catch(error => console.error('Error:', error));
      }
  }

  function updateProductSection(products) {
      const productContainer = document.querySelector('.product');
      productContainer.innerHTML = ''; // Clear existing products

      products.forEach(product => {
          const productCard = `
              <div class="product-card">
                  <a href="/display/${product.id}">
                      <div class="product-tumb">
                          <img src="${product.productImage[0]}" alt="${product.productName}">
                      </div>
                      <div class="product-details">
                          <h4><a href="/display/${product.id}">${product.productName}</a></h4>
                          <div class="product-bottom-details">
                              <div class="product-price">₹${product.price}</div>
                              <div class="product-links">
                                  <a href="#" class="favorite-btn"><i class="fa fa-heart"></i></a>
                                  <a href="#" class="add-to-cart-btn" data-product-id="${product.id}" data-stock-count="${product.stockCount}">
                                      <i class="fa fa-shopping-cart"></i>
                                  </a>
                              </div>
                          </div>
                      </div>
                  </a>
              </div>
          `;
          productContainer.innerHTML += productCard;
      });

  }
  //wishlist
  
  const favoriteButtons = document.querySelectorAll('.favorite-btn');

    // Initialize the wishlist from local storage or an empty array
    // let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
    let wishlist = JSON.parse('<%- JSON.stringify(productIds) %>') || [];
//     let wishlistString = '<%- JSON.stringify(productIds) %>';
// console.log('wishlistString:', wishlistString);

// let wishlist = JSON.parse(wishlistString) || [];
// console.log(wishlist);

    console.log(wishlist);

    // Function to update the heart icon based on the wishlist status
    // const updateHeartIcon = (button, productId) => {
    //     if (wishlist.includes(productId)) {
    //         button.classList.add('active');
    //     } else {
    //         button.classList.remove('active');
    //     }
    // };
    const updateHeartIcon = (button, productId) => {
  
    if (wishlist.includes(productId)) {
        console.log(`Product ${productId} is in the wishlist`);
        button.classList.add('active');
    } else {
        console.log(`Product ${productId} is NOT in the wishlist`);
        button.classList.remove('active');
    }
};

    // Event listener for the heart icons
    favoriteButtons.forEach(button => {
        const productId = button.getAttribute('data-product-id');

        // Update the heart icon on page load
        updateHeartIcon(button, productId);

        button.addEventListener('click', function (event) {
            event.preventDefault();

            // Check if the product is in the wishlist
            const isInWishlist = wishlist.includes(productId);

            // Toggle the 'active' class on the clicked heart icon
            this.classList.toggle('active', !isInWishlist);

            // Update the wishlist array based on the current state
            if (isInWishlist) {
                wishlist = wishlist.filter(id => id !== productId);
            } else {
                wishlist.push(productId);
            }

            // Save the updated wishlist to local storage
            localStorage.setItem('wishlist', JSON.stringify(wishlist));

            // Send a request to the server to add/remove the product from the wishlist
            fetch(`/toggleWishlist/${productId}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ remove: isInWishlist }),
            })
            .then(response => response.json())
            .then(data => {
                if (!data.success) {
                    // If there was an error, revert the local changes
                    updateHeartIcon(this, productId);
                    localStorage.setItem('wishlist', JSON.stringify(wishlist));
                }

                // Use SweetAlert to show a confirmation message
                Swal.fire({
                    icon: 'success',
                    title: isInWishlist ? 'Product removed from wishlist!' : 'Product added to wishlist!',
                    showConfirmButton: false,
                    timer: 1500 // Display the alert for 1.5 seconds
                });
            })
            .catch(error => {
                console.error('Error:', error);
                // Show a generic error message
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'An error occurred. Please try again later.'
                });
            });
        });
    });

</script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="/js/bootstrap.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
      integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
      crossorigin="anonymous"
    ></script>
    

    
    
  </body>
</html>
